{"ast":null,"code":"import _asyncToGenerator from \"D:/project/Customer-project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ComponentRef, ViewContainerRef, ComponentFactoryResolver } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../core/services/data.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"../../shared/pipes/capitalize.pipe\";\nconst _c0 = [\"mapsContainer\"];\n\nfunction CustomerDetailsComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 2)(1, \"div\", 6);\n    i0.ɵɵelement(2, \"img\", 7);\n    i0.ɵɵpipe(3, \"lowercase\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 8)(5, \"h4\");\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"capitalize\");\n    i0.ɵɵpipe(8, \"capitalize\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(9, \"br\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelement(11, \"br\");\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate1(\"src\", \"assets/images/\", i0.ɵɵpipeBind1(3, 6, ctx_r0.customer.gender), \".png\", i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate2(\" \", i0.ɵɵpipeBind1(7, 8, ctx_r0.customer.firstName), \" \", i0.ɵɵpipeBind1(8, 10, ctx_r0.customer.lastName), \"\\u00A0 \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.customer.address, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\" \", ctx_r0.customer.city, \", \", ctx_r0.customer.state.name, \" \");\n  }\n}\n\nfunction CustomerDetailsComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 0);\n    i0.ɵɵtext(1, \" No customer found\\n\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport class CustomerDetailsComponent {\n  constructor(route, dataService, componentFactoryResolver) {\n    this.route = route;\n    this.dataService = dataService;\n    this.componentFactoryResolver = componentFactoryResolver;\n    this.customer = null;\n    this.mapEnabled = false;\n    this.mapComponentRef = {};\n    this.mapsViewContainerRef = {};\n  }\n\n  ngOnInit() {\n    var _a; // Subscribe to params so if it changes we pick it up. Could use this.route.parent.snapshot.params[\"id\"] to simplify it.\n\n\n    (_a = this.route.parent) === null || _a === void 0 ? void 0 : _a.params.subscribe(params => {\n      const id = +params['id'];\n\n      if (id) {\n        this.dataService.getCustomer(id).subscribe(customer => {\n          this.customer = customer;\n\n          if (this.customer && this.customer.latitude) {\n            this.lazyLoadMapComponent(); // this.mapEnabled = true; // For eager loading map\n          }\n        });\n      }\n    });\n  }\n\n  lazyLoadMapComponent() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      if (!_this.mapsViewContainerRef.length) {\n        // Lazy load MapComponent\n        const {\n          MapComponent\n        } = yield import('../../shared/map/map.component');\n        console.log('Lazy loaded map component for customer!');\n        _this.mapComponentRef = _this.mapsViewContainerRef.createComponent(MapComponent);\n        _this.mapComponentRef.instance.zoom = 10;\n        _this.mapComponentRef.instance.customer = _this.customer;\n        _this.mapComponentRef.instance.enabled = true;\n      }\n    })();\n  }\n\n}\n\nCustomerDetailsComponent.ɵfac = function CustomerDetailsComponent_Factory(t) {\n  return new (t || CustomerDetailsComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.DataService), i0.ɵɵdirectiveInject(i0.ComponentFactoryResolver));\n};\n\nCustomerDetailsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CustomerDetailsComponent,\n  selectors: [[\"cm-customer-details\"]],\n  viewQuery: function CustomerDetailsComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5, ViewContainerRef);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.mapsViewContainerRef = _t.first);\n    }\n  },\n  decls: 10,\n  vars: 2,\n  consts: [[1, \"container\"], [\"class\", \"row\", 4, \"ngIf\"], [1, \"row\"], [1, \"col-md-12\"], [\"mapsContainer\", \"\"], [\"class\", \"container\", 4, \"ngIf\"], [1, \"col-md-2\"], [\"title\", \"customer picture\", 1, \"details-image\", 3, \"src\"], [1, \"col-md-10\"]],\n  template: function CustomerDetailsComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtemplate(1, CustomerDetailsComponent_div_1_Template, 13, 12, \"div\", 1);\n      i0.ɵɵelement(2, \"br\")(3, \"br\");\n      i0.ɵɵelementStart(4, \"div\", 2)(5, \"div\", 3)(6, \"div\");\n      i0.ɵɵelementContainer(7, null, 4);\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵtemplate(9, CustomerDetailsComponent_div_9_Template, 2, 0, \"div\", 5);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.customer);\n      i0.ɵɵadvance(8);\n      i0.ɵɵproperty(\"ngIf\", !ctx.customer);\n    }\n  },\n  dependencies: [i3.NgIf, i3.LowerCasePipe, i4.CapitalizePipe],\n  styles: [\".details-image[_ngcontent-%COMP%] {\\n    height:100px;width:100px;margin-top:10px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImN1c3RvbWVyLWRldGFpbHMuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQUNJLFlBQVksQ0FBQyxXQUFXLENBQUMsZUFBZTtBQUM1QyIsImZpbGUiOiJjdXN0b21lci1kZXRhaWxzLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuZGV0YWlscy1pbWFnZSB7XG4gICAgaGVpZ2h0OjEwMHB4O3dpZHRoOjEwMHB4O21hcmdpbi10b3A6MTBweDtcbn0iXX0= */\"]\n});","map":{"version":3,"mappings":";AAAA,SAA4BA,YAA5B,EAAqDC,gBAArD,EAAuEC,wBAAvE,QAAuG,eAAvG;;;;;;;;;;ICCEC,+BAAkC,CAAlC,EAAkC,KAAlC,EAAkC,CAAlC;IAEIA;;IACFA;IACAA,+BAAuB,CAAvB,EAAuB,IAAvB;IAEMA;;;IACJA;IACAA;IACAA;IACAA;IACAA;IACFA;;;;;IAVOA;IAAAA;IAIDA;IAAAA;IAGJA;IAAAA;IAEAA;IAAAA;;;;;;IAmBNA;IACGA;IACHA;;;;ADrBA,OAAM,MAAOC,wBAAP,CAA+B;EASnCC,YAAoBC,KAApB,EACUC,WADV,EAEUC,wBAFV,EAE4D;IAFxC;IACV;IACA;IATV,gBAA6B,IAA7B;IACA,kBAAsB,KAAtB;IACA,uBAAqC,EAArC;IAGQ,4BAAyC,EAAzC;EAIyD;;EAEjEC,QAAQ;WAAA,CACN;;;IACA,WAAKH,KAAL,CAAWI,MAAX,MAAiB,IAAjB,IAAiBC,aAAjB,GAAiB,MAAjB,GAAiBA,GAAEC,MAAF,CAASC,SAAT,CAAoBD,MAAD,IAAmB;MACrD,MAAME,EAAE,GAAG,CAACF,MAAM,CAAC,IAAD,CAAlB;;MACA,IAAIE,EAAJ,EAAQ;QACN,KAAKP,WAAL,CAAiBQ,WAAjB,CAA6BD,EAA7B,EACGD,SADH,CACcG,QAAD,IAAwB;UACjC,KAAKA,QAAL,GAAgBA,QAAhB;;UACA,IAAI,KAAKA,QAAL,IAAiB,KAAKA,QAAL,CAAcC,QAAnC,EAA6C;YAC3C,KAAKC,oBAAL,GAD2C,CAE3C;UACD;QACF,CAPH;MAQD;IACF,CAZgB,CAAjB;EAaD;;EAEKA,oBAAoB;IAAA;;IAAA;MACxB,IAAI,CAAC,KAAI,CAACC,oBAAL,CAA0BC,MAA/B,EAAuC;QACrC;QACA,MAAM;UAAEC;QAAF,UAAyB,OAAO,gCAAP,CAA/B;QACAC,OAAO,CAACC,GAAR,CAAY,yCAAZ;QACA,KAAI,CAACC,eAAL,GAAuB,KAAI,CAACL,oBAAL,CAA0BM,eAA1B,CAA0CJ,YAA1C,CAAvB;QACA,KAAI,CAACG,eAAL,CAAqBE,QAArB,CAA8BC,IAA9B,GAAqC,EAArC;QACA,KAAI,CAACH,eAAL,CAAqBE,QAArB,CAA8BV,QAA9B,GAAyC,KAAI,CAACA,QAA9C;QACA,KAAI,CAACQ,eAAL,CAAqBE,QAArB,CAA8BE,OAA9B,GAAwC,IAAxC;MACD;IATuB;EAUzB;;AAxCkC;;;mBAAxBxB,0BAAwBD;AAAA;;;QAAxBC;EAAwByB;EAAAC;IAAA;6BAMC7B;;;;;;;;;;;;;;MClBtCE;MACEA;MAcAA,sBAAM,CAAN,EAAM,IAAN;MACAA,+BAAiB,CAAjB,EAAiB,KAAjB,EAAiB,CAAjB,EAAiB,CAAjB,EAAiB,KAAjB;MAUQA;MACJA;MAINA;;;;MA9BoBA;MAAAA;MA8BdA;MAAAA","names":["ComponentRef","ViewContainerRef","ComponentFactoryResolver","i0","CustomerDetailsComponent","constructor","route","dataService","componentFactoryResolver","ngOnInit","parent","_a","params","subscribe","id","getCustomer","customer","latitude","lazyLoadMapComponent","mapsViewContainerRef","length","MapComponent","console","log","mapComponentRef","createComponent","instance","zoom","enabled","selectors","viewQuery"],"sourceRoot":"","sources":["D:\\project\\Customer-project\\src\\app\\customer\\customer-details\\customer-details.component.ts","D:\\project\\Customer-project\\src\\app\\customer\\customer-details\\customer-details.component.html"],"sourcesContent":["import { Component, OnInit, ComponentRef, ViewChild, ViewContainerRef, ComponentFactoryResolver } from '@angular/core';\nimport { ActivatedRoute, Params } from '@angular/router';\n\nimport { ICustomer } from '../../shared/interfaces';\nimport { DataService } from '../../core/services/data.service';\nimport { MapPointComponent } from 'src/app/shared/map/map-point.component';\n\n@Component({\n  selector: 'cm-customer-details',\n  templateUrl: './customer-details.component.html',\n  styleUrls: ['./customer-details.component.css']\n})\nexport class CustomerDetailsComponent implements OnInit {\n\n  customer: ICustomer | null = null;\n  mapEnabled: boolean = false;\n  mapComponentRef: ComponentRef<any> = {} as ComponentRef<any>;\n\n  @ViewChild('mapsContainer', { read: ViewContainerRef }) \n  private mapsViewContainerRef: ViewContainerRef = {} as ViewContainerRef;\n\n  constructor(private route: ActivatedRoute, \n    private dataService: DataService,\n    private componentFactoryResolver: ComponentFactoryResolver) { }\n\n  ngOnInit() {\n    // Subscribe to params so if it changes we pick it up. Could use this.route.parent.snapshot.params[\"id\"] to simplify it.\n    this.route.parent?.params.subscribe((params: Params) => {\n      const id = +params['id'];\n      if (id) {\n        this.dataService.getCustomer(id)\n          .subscribe((customer: ICustomer) => {\n            this.customer = customer;\n            if (this.customer && this.customer.latitude) {\n              this.lazyLoadMapComponent();\n              // this.mapEnabled = true; // For eager loading map\n            }\n          });\n      }\n    });\n  }\n\n  async lazyLoadMapComponent() {\n    if (!this.mapsViewContainerRef.length) {\n      // Lazy load MapComponent\n      const { MapComponent } = await import('../../shared/map/map.component');\n      console.log('Lazy loaded map component for customer!');\n      this.mapComponentRef = this.mapsViewContainerRef.createComponent(MapComponent);\n      this.mapComponentRef.instance.zoom = 10;\n      this.mapComponentRef.instance.customer = this.customer;\n      this.mapComponentRef.instance.enabled = true;\n    }\n  }\n\n\n}\n","<div class=\"container\">\n  <div class=\"row\" *ngIf=\"customer\">\n    <div class=\"col-md-2\">\n      <img src=\"assets/images/{{customer.gender | lowercase}}.png\" class=\"details-image\" title=\"customer picture\" />\n    </div>\n    <div class=\"col-md-10\">\n      <h4>    \n          {{ customer.firstName | capitalize }} {{ customer.lastName | capitalize }}&nbsp;          \n      </h4>\n      <br />\n      {{ customer.address }}\n      <br />\n      {{ customer.city }}, {{ customer.state.name }}\n    </div>\n  </div>    \n  <br /><br />\n  <div class=\"row\">\n    <div class=\"col-md-12\">\n      <!-- <cm-map [latitude]=\"customer.latitude\" \n           [longitude]=\"customer.longitude\" \n           [zoom]=\"10\" \n           [enabled]=\"mapEnabled\"\n           [markerText]=\"'<h3>' + customer.firstName + ' ' + customer.lastName + '</h3>' + customer.city + ', ' + customer.state.name\"></cm-map> -->\n          \n      <!-- lazy load the map component -->\n      <div>\n          <ng-container #mapsContainer></ng-container>\n      </div>\n    </div>\n  </div>\n</div>   \n<div *ngIf=\"!customer\" class=\"container\">\n   No customer found\n</div>  "]},"metadata":{},"sourceType":"module"}